<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">

  <link href="/jsoneditor.css" rel="stylesheet" type="text/css">
  <script src="/jsoneditor.js"></script>
</head>

<div class="container">
  <h1>Edit Format</h1>

  <%= simple_form_for @format, id: "editFormat" do |f| %>
    <%= f.input :title %>
    <%= f.input :multiline, as: :boolean %>

    <%= hidden_field_tag(:json, '') %>

    <div class="container" id="jsoneditor" style="height: 400px;"></div>

    <script>
        //set jsoneditor
        var container = document.getElementById("jsoneditor");
        var editor = new JSONEditor(container, {mode: 'code'});

        //replace the EOF char for empty char so that the jsoneditor doesn't complain
        var json = <%= @json.gsub(/\x0A/, '').html_safe %>;
        editor.set(json);
    </script>


    <footer>
      <%= link_to ' Cancel', "/formats", class: "btn btn-outline-primary fas fa-angle-left" %>
      <%= f.submit "Update", class: "btn btn-primary fas", onclick: "$('#json').val(JSON.stringify(editor.get()));" %>
    </footer>
  <% end %>
</div>